# 演習 2、タスク 4: Northwind ビジネス インサイト エージェントを作成する
---
Northwind Traders のリーダーは、市場のトレンドに遅れないため、売上、サプライ チェーン、顧客センチメント全体についての実績メトリックをリアルタイムで可視化する必要があります。 あなたは、定期的なレポートを待つ代わりに、Microsoft 365 Copilot で Northwind ビジネス インサイト エージェントを作成して、重要なインジケーターを積極的に監視し、Northwind の重役のために新しい問題に注意を促すことを計画しています。 このタスクでは、実績を追跡して実用的な分析情報を提供するようにエージェントを構成し、予測された結果からの逸脱に迅速に対応できるようにします。

> [!NOTE] 
> この演習では、Copilot Studio Lite エクスペリエンスを使って Northwind ビジネス インサイト エージェントを作成します。 このシンプル エクスペリエンスは、普通のビジネス ユーザー向けに設計されており、プログラミング スキルは必要ありません。 一方、より複雑で高度なエージェントを構築するソフトウェア開発者は、通常、Copilot Studio のフル エクスペリエンスを使用します。

このシナリオでは、Copilot エージェントによって、経営陣が事後対応型の管理から積極的な分析情報主導のリーダーシップにどのように移行できるかを示します。

このタスクを完了するには、次の手順を実行します。

1.  Microsoft Edge ブラウザーで新しいタブを開き、Microsoft 365 を開きます。

2.  Microsoft 365 のナビゲーション ウィンドウで **[新しいエージェント]** を選択します。 これにより、Copilot Studio の**エージェント ビルダー**が開き、**[新しいエージェント]** ページが表示されます。

    **[新しいエージェント]** ページでエージェントを作成するよう Copilot に依頼します。 プロンプトには、エージェントの名前と、エージェントの概要、対象ユーザー、想定する動作などの一般的な説明を入力する必要があります。  
        <br/>このエージェントの場合は、次のプロンプトを入力し、進む矢印 (送信) アイコンを選択して、プロンプトを送信します。  
        <br/>**Northwind ビジネス インサイト エージェントという名前のエージェントを作成します。このエージェントの目的は、Northwind Traders の売上実績、サプライ チェーンの正常性、顧客センチメント、および第 4 四半期の予算予測と比較した結果に関連する質問への回答を提供することです。エージェントは、それに割り当てられているファイルのみをナレッジ ソースとして使用する必要があります。このエージェントの想定される対象ユーザーはエグゼクティブです。**

3.  進む矢印を選択すると、新しいエージェント用の**エージェント ビルダー** フォームが表示されます。 このフォームの上部に、**[説明]** タブと **[構成]** タブがあります。
    - **[説明]** タブを使用して、Copilot と会話を続けることができます。 このタブは既定で表示されます。

    - **[構成]** タブでは、エージェントを動作させるための詳細な設定を定義できます。
    
    Copilot によってエージェントが作成されるまで 1 から 2 分待つと、**[エージェント プレビュー]** ペインにエージェントの名前と説明が表示されます。

4.  フォームの上部にある **[構成]** タブを選択します。 入力したプロンプトに基づいて Copilot が実行した内容を確認しましょう。

5.  **[構成]** タブの **[名前]** フィールドと **[説明]** フィールドは、入力したプロンプトに基づいて設定されているはずです。 **[指示]** フィールドまで下スクロールします。 最初のプロンプトで指定した説明に基づいて、Copilot によってこれらの指示が生成されました。 Copilot によって生成された指示の詳細レベルを確認します。

   > [!IMPORTANT]
   > エージェント ビルダー プロセスの優れた点は、基本的な自然言語による説明が、Copilot によって複雑な一連の指示に自動的に変換されることです。 このようなプロセスが用意されているため、ユーザーは詳細な命令セットを自分で作成する必要がなくなります。

6.  指示を変更する場合は、**[指示]** フィールドで直接手動で編集するか、指示の更新を Copilot に依頼することができます。  
    <br/>あなたは **[指示]** を確認した後、指示セットに他の項目をいくつか追加するよう Copilot に依頼することにしました。 これを行うには、**[説明]** タブを選んで、次のプロンプトを入力します。

    **次の項目を含むように指示を更新します: 応答を生成するとき、エージェントは次のようにする必要があります:**
    
    - **足りない情報または不完全な情報にフラグを設定します**
    - **定義されたナレッジ ソース ドキュメントの外部で、データを作ったり、ソースに依存したりしないでください**
    - **Northwind Traders のビジネス コンテキスト内に留まってください**

7.  指示を更新した後、Copilot の応答を確認します。 Copilot が行った変更を確認するには、**[構成]** タブを選び、**[指示]** フィールドまで下にスクロールします。 要求した新しい指示が Copilot によって追加されたことを確認します。

8.  現在の指示は良さそうですが、改善の余地もありそうです。 どのように改善すればよいかわからないので、Copilot に意見を聞くことにします。  
    <br/>そのためには、**[説明]** タブを選択します。今回は、このエージェントを改善するために推奨される他の指示を Copilot に尋ねるプロンプトを入力します。

9.  Copilot の推奨を確認します。 その提案に満足したので、エージェントの指示にそれらをすべて追加するよう Copilot に依頼します。

10.  指示を更新したことを Copilot が応答したら、**[構成]** タブを選んで **[指示]** までスクロールします。 Copilot によって追加された新しい項目に注目してください。

11.  これで、指示は満足できるものになり、エージェントのナレッジ ソースとスターター プロンプトを構成する準備ができました。  
    <br/>**[構成]** タブで **[ナレッジ]** セクションまで下にスクロールし、**[すべての Web サイトを検索する]** トグル スイッチが無効になっていることを確認します。 元のプロンプトで指定した説明に基づいてエージェントを作成する際には、提供したファイルのみを使用するように指示したため、Copilot により、このトグル スイッチは無効にされているはずです。 トグル スイッチが有効になっている場合は、ここで無効にします。

12.  **[ナレッジ]** セクションの **[URL または名前を入力するか、ここにファイルをドロップしてください]** フィールドの横に表示される **[デバイスからアップロード]** アイコンを選択します。 表示された**エクスプローラー** ウィンドウで、**OneDrive** フォルダーに移動し、タスク 1 の **Q3 Executive Briefing.docx** ファイルを選んで、タスク 2 の **Northwind Traders Q4 budget forecast.xlsx** ファイルをエージェントのナレッジ ソースとして選びます。

13.  **[推奨プロンプト]** では、Copilot にプロンプトを生成させることも、独自のプロンプトを手作りすることもできます。 両方の方法を試してみましょう。  
    <br/>Copilot に提案プロンプトを生成してもらうには、**[説明]** タブを選択し、エージェントに対して 3 つの提案プロンプトを生成するよう Copilot に依頼します。 各プロンプトにタイトルとメッセージがある点に注目してください。

14. 次に、独自のプロンプトをいくつか入力します。 **[構成]** タブを選択し、**[提案されたプロンプト]** セクションまで下にスクロールします。 Copilot によってエージェントに追加された 3 つのプロンプトが表示されます。  
    <br/>手作業で追加するプロンプトごとに、プロンプトの下に表示される **[推奨プロンプトを 1 つ追加する]** オプションを選びます。  
    <br/>一般的な財務トピックとアクションに関連する 6 つの提案プロンプトが下に表示されます。 これらのプロンプトを確認し、気に入ったプロンプトを 2 つか 3 つ選んで、エージェントに追加します。

    - **タイトル:** 上位のリスク
        - **メッセージ:** 第 4 四半期の収益予測を満たす上で最も高いリスクは何ですか?  
            
    - **タイトル:** 顧客センチメントの傾向
        - **メッセージ:** 最新のレポートから顧客センチメントの傾向を要約します。 (注: ナレッジ ソース内のデータを考えると、このプロンプトは興味深いものです。 このプロンプトを使うとどうなるか確認してください)。  
            
    - **タイトル:** 予算と売上の対比
        - **メッセージ:** 実績売上と第 4 四半期の予算予測を比較します。  
            
    - **タイトル:** ボトルネック
        - **メッセージ:** 第 4 四半期の納入タイムラインに影響する可能性があるサプライ チェーンのボトルネックを特定します。  
            
    - **タイトル:** 実績が上位の製品カテゴリ
        - **メッセージ:** 最近の売上データに基づいて、実績上位の製品カテゴリを明らかにします。  
            
    - **タイトル:** 新興市場の動向
        - **メッセージ:** 次の四半期には、どの新興市場の動向に注目する必要がありますか?  
            
15. 提案されたプロンプトをいくつかテストします。 エージェントがデータをナレッジ ソースのドキュメントから正しく引き出していることを確認します。

16. 推奨プロンプトの結果に問題がなければ、**[作成]** ボタンを選んでエージェントを作成します。

17. エージェントが作成されると、エージェントが正常に作成されたことを示すダイアログ ボックスが表示されます。 このダイアログ ボックスから、そのエージェントに移動することも、共有することもできます。 **[エージェントに移動する]** オプションを選択します。

> [!NOTE]
> この段階では、エージェントは非公開であり、アクセスできるのはあなただけです。 実務のシナリオで、エージェントを複数のチーム メンバーが使用する必要がある場合は、その人々と共有することになります。 このトレーニング演習では、あなた専用のテナント内で作業しているため、共有は必要ありません。



