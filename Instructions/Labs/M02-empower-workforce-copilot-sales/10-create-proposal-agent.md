# 演習 2、タスク 3: Copilot Studio を使用して RFP 応答エージェントを構築する
---
Fabrikam の EcoSense 360 での販売の成功は、ホテルやリゾートから強い関心を生み出しましたが、同時に新たな課題も生み出しました。 営業チームは、統合、省エネ、製品の機能について同様の質問をする初期段階の RFP に回答するのに毎週数時間を費やしています。 このボトルネックに対処するために、Fabrikam の営業担当副社長は、これらの最初の質問を自動的に処理できる Copilot エージェントの開発をあなたに任せました。 

あなたは、Copilot Studio を使って次の 2 つの機能を実行するエージェントを構築することを計画します。1 つ目として、既存の EcoSense 360 製品資料から引き出された暫定的な回答を提供し、2 つ目として、提出された RFP に対する回答を生成します。 このエージェントにより、応答時間が短縮され、より価値の高い機会に集中できるように営業チームを解放し、見込み顧客により迅速で魅力的なエクスペリエンスが提供される必要があります。

> [!NOTE]
> この演習では、Copilot Studio Lite エクスペリエンスを使用して、EcoSense 360 RFP 応答エージェントを作成します。 このシンプル エクスペリエンスは、普通のビジネス ユーザー向けに設計されており、プログラミング スキルは必要ありません。 一方で、より複雑で高度なエージェントを構築するソフトウェア開発者は、通常、Copilot Studio Full エクスペリエンスを使用します。

このタスクを完了するには、次の手順を実行します。

1.  次のリンクを選択して、新しい EcoSense 360 RFP 応答エージェントのナレッジ ソース コンテンツを提供するすべてのドキュメントをダウンロードします。

    - [**EcoSense_360_Compliance_Certification_Summary**](https://go.microsoft.com/fwlink/?linkid=2347612)

    - [**EcoSense_360_Customer_Case_Study**](https://go.microsoft.com/fwlink/?linkid=2347522)

    - [**EcoSense_360_Integration_Compatibility_Guide**](https://go.microsoft.com/fwlink/?linkid=2347523)

    - [**EcoSense_360_Sample_Pricing_Sheet**](https://go.microsoft.com/fwlink/?linkid=2347613)

    - [**EcoSense_360_Technical_Specifications**](https://go.microsoft.com/fwlink/?linkid=2347614)

    これらのファイルを、タスク 1 で OneDrive に作成した **EcoSense360-RFP-Documents** フォルダーに格納します。 これらのドキュメントは、EcoSense 360 RFP 応答エージェントのナレッジ ソースとなります。

2.  次のリンクを選択して、新しい EcoSense 360 RFP 応答エージェントをテストするときに使用する予定の RFP ドキュメントをダウンロードします。

    - [**VanArsdel_RFP.docx**](https://go.microsoft.com/fwlink/?linkid=2347622)

    この RFP ファイルを **OneDrive** フォルダーに格納します。
    
   > [!CAUTION]
   > **VanArsdel_RFP.docx** ファイルは **EcoSense360-RFP-Documents** フォルダーに保存しないでください。 このフォルダーは、新しいエージェントのナレッジ ソース ドキュメント専用です。

3.  Microsoft Edge ブラウザーで新しいタブを開き、Microsoft 365 を開きます。

4.  Microsoft 365 のナビゲーション ウィンドウで **[新しいエージェント]** を選択します。 これにより、Copilot Studio の**エージェント ビルダー**が開き、**[新しいエージェント]** ページが表示されます。

5.  **[新しいエージェント]** ページで、Copilot にエージェントを作成するよう依頼します。 プロンプトで、エージェントの名前と、エージェントの概要、対象ユーザー、それで何を実行したいかの一般的な説明を入力する必要があります。  
    <br/>このエージェントの場合は、次のプロンプトを入力し、進む矢印 (送信) アイコンを選択して、プロンプトを送信します。  
    <br/>**EcoSense 360 RFP 応答エージェントという名前のエージェントを作成してください。このエージェントの目的は、顧客の販売提案に関連する質問に対する回答を営業チームに提供することです。また、このエージェントは、EcoSense 360 エネルギー管理ソリューションに対する顧客の RFP に対して、顧客向けの完全な回答を生成できる必要があります。ナレッジ ソースとして、エージェントは EcoSense360-RFP-Documents フォルダー内に保存されたドキュメントのみを使用するものとします。RFP 応答は、EcoSense_360_RFP_Template.dotx という名称のテンプレート ファイルに基づいている必要があります。**

6.  進む矢印を選択すると、新しいエージェント用の**エージェント ビルダー** フォームが表示されます。 フォームの上部には、**[説明]** タブと **[構成]** タブがあります。
    - **[説明]** タブを使用すると、Copilot との会話を続けられます。 このタブは既定で表示されます。
    - **[構成]** タブでは、エージェントを動作させるための詳細な設定を定義できます。

    Copilot がエージェントを作成するまで 1 から 2 分待つと、エージェントの名前と説明が **[エージェント プレビュー]** ペインに表示されます。

7.  フォームの上部で、**[構成]** タブを選択します。 入力したプロンプトに基づいて、Copilot が何を行ったかを見てみましょう。

8.  **[構成]** タブの **[名前]** フィールドと **[説明]** フィールドは、入力したプロンプトに基づいて設定されているはずです。 **[指示]** フィールドまで下にスクロールします。 最初のプロンプトで指定した説明に基づいて、Copilot によってこれらの指示が生成されました。 Copilot が生成した詳細なレベルの指示を確認します。

   > [!IMPORTANT]
   > エージェント ビルダー プロセスの優れた点は、基本的な自然言語による説明が、Copilot によって複雑な一連の指示に自動的に変換されることです。 このようなプロセスが用意されているため、ユーザーは詳細な命令セットを自分で作成する必要がなくなります。

9.  指示を変更する場合は、**[指示]** フィールドで直接手動で編集するか、指示の更新を Copilot に依頼することができます。  
    <br/>あなたは **[指示]** を確認した後、指示セットに他の項目をいくつか追加するよう Copilot に依頼することにしました。 これを行うには、**[説明]** タブを選択し、次のプロンプトを入力します。

    **次の項目を含めるよう指示を更新します。**
    
    - **応答は、RFP の書式規則に従い、コンプライアンスおよび価格の表が含まれ、プロフェッショナルかつ顧客に重点を置いたトーンである必要があります**。
    - **必要に応じて、短いラベルと箇条書きを使用し、応答がわかりやすく書式設定されていることを確認してください。**
    - **すべての回答に出典を明記してください。**
    - **不足している情報にフラグを立ててください。**
    
10.  指示を更新したら、Copilot の応答を確認します。 Copilot が行った変更を確認するには、**[構成]** タブを選択し、**[指示]** フィールドまで下にスクロールします。 要求した新しい指示を Copilot が追加していることを確認します。

11.  この時点の指示は問題なさそうに見えますが、まだ改良できるかもしれないとあなたは考えます。 どのように改善すればよいかわからないので、Copilot に意見を聞くことにしました。  
    <br/>そのためには、**[説明]** タブを選択します。今回は、このエージェントを改善するために推奨される他の指示を Copilot に尋ねるプロンプトを入力します。

12.  Copilot の推奨事項を確認します。 提案に満足したので、それらをすべてエージェントの指示に追加するよう Copilot に依頼します。

13.  指示を更新したという応答が Copilot からあったら、**[構成]** タブを選択し、**[指示]** をスクロールします。 Copilot によって追加された新しい項目に注目してください。

14.  指示に満足したら、エージェントのナレッジ ソースとスターター プロンプトを構成する準備は完了です。  
    <br/>**[構成]** タブで、**[ナレッジ]** セクションまで下にスクロールし、**[すべての Web サイトを検索する]** トグル スイッチが無効になっていることを確認します。 Copilot は、元のプロンプトで指定した説明に基づいてエージェントを作成する際には、EcoSense360-RFP-Documents フォルダーに格納されたファイルのみを使用するように指示されているため、このトグル スイッチを無効にしているはずです。 トグル スイッチが有効になっている場合は、ここで無効にします。

15.  **[ナレッジ]** セクションの **[URL または名前を入力するか、ここにファイルをドロップしてください]** フィールドの横に表示される **[デバイスからアップロード]** アイコンを選択します。 表示された**エクスプローラー** ウィンドウで、**OneDrive** フォルダーに移動し、**EcoSense360-RFP-Documents** フォルダーを選択します。 このフォルダー内のすべてのファイルを選択し、**[開く]** ボタンを選択します。

16.  **[ナレッジ]** セクションの一番下までスクロールし、選択したすべてのドキュメントが **[アップロード済みのファイル]** の一覧に表示されていることを確認します。

17.  **[推奨プロンプト]** では、Copilot にプロンプトを生成してもらうか、手動で独自のプロンプトを作成することができます。 両方の方法を試してみましょう。  
    <br/>Copilot に推奨プロンプトを生成してもらうには、**[説明]** タブを選択し、エージェントに対して 3 つの推奨プロンプトを生成するよう Copilot に依頼します。 各プロンプトにタイトルとメッセージがある点に注目してください。

18.  次に、独自のプロンプトをいくつか入力します。 **[構成]** タブを選択し、**[推奨プロンプト]** セクションまで下にスクロールします。 Copilot がエージェントに追加した 3 つのプロンプトが表示されます。  
    <br/>手動で追加するプロンプトごとに、プロンプトの下に表示される **[推奨プロンプトを 1 つ追加する]** オプションを選択します。  
    <br/>以下に、EcoSense 360 エネルギー管理ソリューションに関する質問を行う 6 つの推奨プロンプトを示します。 これらのプロンプトを確認し、2 つまたは 3 つのプロンプトを選択して、それらをエージェントに追加します。
    
        - **タイトル:** 製品の概要と利点
            - **メッセージ:** 製品の概要と、利点の一覧を提供してください。
            
        - **タイトル:** 競合他社との差別化
            - **メッセージ:** 競合他社と比較して、差別化要因の 1 ページ要約を提供してください。
            
        - **タイトル:** 成果物統合
            - **メッセージ:** 製品が既存のホテル管理システムとどのように統合されるかについて説明してください。
            
        - **タイトル:** 成果物統合
            - **メッセージ:** EcoSense 360 は HVAC システムや照明システムとどのように統合されますか。
            
        - **タイトル:** 価格
            - **メッセージ:** 大規模なリゾート チェーン向けにどのような価格オプションがありますか?
            
        - **タイトル:** 省エネと ROI
            - **メッセージ:** ホテルの省エネと ROI に重点を置いたエグゼクティブ サマリーの草案を作成してください。
    
19.  推奨プロンプトをいくつかテストします。 エージェントがデータをナレッジ ソースのドキュメントから正しく引き出していることを確認します。

20.  ここで、添付された販売提案ファイルに基づいて RFP ドキュメントを生成するようにエージェントに求める最終的な推奨プロンプトを追加します。

   > [!NOTE]
   > 前の手順で、いくつかのプロンプトをテストし終えるまで、この推奨プロンプトを入力するのは控えていました。 これは、Copilot Studio の [テスト] ペインでは現在、プロンプト フィールドにファイルを添付できないためです。 そのため、前の手順でプロンプトをテストする際に混乱が生じるのを避けたかったためです。

   次の推奨プロンプト (後の手順でテストします) を追加します。  
    
   - **タイトル:** RFP 応答を生成する
      - **メッセージ:** 添付された販売提案書の RFP 応答を作成してください。 EcoSense_360_RFP_Template に基づいて結果を Word 文書として整形します。 文書をダウンロードするためのリンクを指定します。

21.  エージェントの構成が完了したので、**[作成]** ボタンを選択してエージェントを作成します。

22.  エージェントが作成されると、エージェントが正常に作成されたことを示すダイアログ ボックスが表示されます。 このダイアログ ボックスから、そのエージェントに移動することも、共有することもできます。 **[エージェントに移動する]** オプションを選択します。

   > [!NOTE]
   > この段階では、エージェントは非公開であり、アクセスできるのはあなただけです。 実務のシナリオで、エージェントを複数のチーム メンバーが使用する必要がある場合は、その人々と共有することになります。 このトレーニング演習では、あなた専用のテナント内で作業しているため、共有は必要ありません。

23.  ここで、前に追加した最終的な推奨プロンプト (販売提案に対する RFP 応答を作成する) をテストします。 
    <br/><br/>**[EcoSense 360 RFP 応答エージェント]** ウィンドウで、**[RFP 応答を生成する]** 推奨プロンプト (**[添付された RFP の RFP 応答を作成してください]**) を選択します。 OneDrive アカウントから **VanArsdel_RFP.docx** ファイルを添付して、プロンプトを送信します。

24.  結果を確認します。 次の 2 つの結果のいずれかが発生する場合があります。

        - テスト時に、Copilot によりダウンロード可能な Word 文書を生成できなかったことが示された。 このような状況が発生した場合は、結果の末尾にある **[コピー]** オプションを選択して、RFP 応答をクリップボードにコピーします。 次に、**Word** を開き、コピーしたテキストを貼り付け、結果の先頭と末尾に表示される可能性がある余分な文言を削除してから、ファイルを **VanArsdel-RFP-Proposal.docx** として OneDrive に保存します。 ファイルを開いたままにしておきます。

        - Microsoft 365 Copilot はまだ進行中であるため、この演習を完了するまでにダウンロード可能な Word 文書が提供される場合があります。 Copilot により文書が生成される場合は、リンクを選択してダウンロードし、ダウンロードした Word 文書を開きます。

   > [!IMPORTANT]
   > Word 文書を作成するか、生成された文書をダウンロードする前に (可能な場合)、結果の最後に表示される推奨プロンプトを確認してください。 エージェントに結果を更新させたい場合、これらの任意のプロンプトを自由に送信できます。 たとえば、表紙と目次を含めるかどうか聞かれる場合があります。 または、より多くの要件でコンプライアンス マトリックスを拡張するなど、更新をさらに行いたいかどうか聞かれる場合もあります。 エージェントに追加の機能を使用して RFP 応答をカスタマイズさせたい場合は、ここで実行できます。

25.  Word 文書内の RFP 応答を確認します。 エージェントは、応答のために **EcoSense_360_RFP_Template.dotx** という名前の定義済みのテンプレート ファイルを使用したことを思い出してください。 テンプレート内のフィールドに何も入力していない場合は、手動でフィールドを自分で更新 (あるいは削除または置換) する必要があります。  
    <br/>この時点でも、エージェントに支援を求めることができます。 必要に応じて、クエリを含むプロンプトをエージェントに送信し、必要に応じて結果をコピーして RFP 応答ファイルに貼り付けることができます。

26.  **VanArsdel-RFP-Proposal.docx** は、この演習の最後のタスクで使用されているため、開いたままにします。



