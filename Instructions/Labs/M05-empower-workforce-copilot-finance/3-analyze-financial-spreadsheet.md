#  Microsoft 365 Copilot in Excel を使用して財務スプレッドシートを分析する
---
財務担当者向けに、Microsoft 365 Copilot in Excel には、数式だけに頼るのではなく、自然言語でデータ セットに関する質問をする機能など、多くの利点があります。 このツールを使用すると、相関関係を明らかにし、what-if シナリオを提案し、クエリに基づいて強力な視覚化を作成できます。 たとえば、Copilot in Excel を使用して、種類とチャネル別に売上データを分類することができます。 または、データ内の変数の変化の影響を予測し、グラフを生成して視覚化することができます。 また、変数の増加率に対する変更がどのように粗利益率に影響を与えるかをモデル化することもできます。

Copilot in Excel を使用すると、反復的なタスクを自動化できます。 そうすることで、従業員はより創造的で革新的なアプローチを取ることができるようになり、さまざまな事業分野の進歩が加速します。 これは、毎日のプロセスを合理化し、より多くの情報に基づいた意思決定を行いたい財務担当者にとって価値があるツールです。

Copilot in Excel を使用するには、次のいずれかの方法でデータを書式設定する必要があります。

- **Excel の表。** データを Excel テーブルとして書式設定できます。 この方法は、データの操作や分析が容易になるため、多くの場合、推奨される方法です。 データを Excel テーブルとして書式設定すると (**[挿入] > [テーブル]** オプションを使用)、データは名前付き範囲を使用して構造化された方法で整理され、フィルター処理、並べ替え、列の簡単な参照などの特定の機能が Excel によって自動的に適用されます。 これにより、Copilot はデータをより効果的に理解し、操作できるようになります。

- **範囲データ。** Copilot は、非テーブル形式とも呼ばれる通常の範囲のデータも分析し、支援することができます。 Copilot in Excel を使って、分析情報を生成し、データを要約し、数式を作成し、提案を表示することができます。 ただし、テーブルのようにあらかじめ定義された構造がないため、非テーブル形式のデータの処理には制限が多くなる可能性があります。 

この演習では、Copilot in Excel を使用して、Excel のテーブル形式で書式設定されている市場動向のスプレッドシートを分析します。 この演習では、Copilot の多くの事前構築済み関数とプロンプトを確認します。

### 演習

あなたは、Fabrikam の財務部長として、会社の Q1 マーケティング キャンペーンの効果を分析したいと考えています。 マーケティング部長から、第 1 四半期に会社が関与した各マーケティング キャンペーンを識別するスプレッドシートが提供されました。 スプレッドシートには、基本的な予算と収益の数値と、対象ユーザーとエンゲージメントの高いユーザーの数が表示されています。 キャンペーンの種類ごとの効果を判断するために、数値を分析するのはあなたの仕事です。

Copilot in Excel を使用して、Q1 マーケティング キャンペーン スプレッドシートに表示されるデータを分析するには、次の手順を実行します。

1. 次のリンクを選択して、[Fabrikam Q1 マーケティング キャンペーン](https://go.microsoft.com/fwlink/?linkid=2269124) スプレッドシートをダウンロードします。
1. ダウンロードが完了したら、**エクスプローラー**を開き、**ダウンロード** フォルダーから **Microsoft - OneDrive** フォルダーにファイルをコピーします。
1. この演習では、Excel の最近使用したファイルの一覧からドキュメントにアクセスします。 ファイルが MRU 一覧に表示されるようにするには、ドキュメントを開いて閉じます。 
1. Edge ブラウザーを開き (必要な場合)、次の URL を入力して **Microsoft 365** ホーム ページに移動します: **https://www.office.com**  
1. **[Microsoft 365]** ホーム ページの左側のナビゲーション ウィンドウで **[Excel]** アイコンを選択します。 アイコンが表示されない場合は、ナビゲーション ウィンドウで **[アプリ]** を選択し、**[アプリ]** ページから **[Excel]** を選択します。
1. **Excel** の MRU 一覧で、すべてのファイルの一覧まで下にスクロールします。 **[すべて]** タブは既定で表示されます。 **Fabrikam Q1 marketing campaigns** ファイルを選択します。
1. **Excel** でスプレッドシートを開き、リボンの右側にある **[Copilot]** オプションを選択します (リボンが表示されていない場合は、**[ホーム]** タブを選択します)。 これにより、**Copilot** ウィンドウが開きます。 
1. 表示される **Copilot** ウィンドウで、表示される定義済みのプロンプトをメモします。 これらの定義済みのプロンプトのいずれかを選択して分析を改善する前に、まず、Copilot でスプレッドシートに対して特定の変更を加える必要があります。 最初に、Copilot に最も収益性の高いキャンペーンの種類を特定してもらいます。 これを行うには、次のプロンプトを入力します。**ピボット テーブルを作成して、各キャンペーンの種類によって生成された合計収益を分析します**。
1. このプロンプトの結果を確認します。 Copilot により、Copilot ウィンドウに 2 つの応答が表示されました。 最初の応答には、キャンペーンの種類別の総収益を要約したピボット テーブルが含まれていました。 2 番目の応答には、最初の応答で行ったことの説明が含まれていました。 このテーブルを含む最初の応答で、**[新しいシートに追加]** ボタンを選択します。 これにより、このスプレッドシートの **Sheet 2** にこのテーブルが追加され、Copilot が開きます。 Sheet2 が表示されない場合は、ページの上部にある URL アドレス バーの横にある **[更新]** アイコンを選択します。
1. **Sheet 2** を見ると、ピボット テーブルに付随するグラフが Copilot によって作成されなかったことがわかります。 送信したプロンプトを見ると、あなたは、ピボット テーブルの作成を要求しただけで、グラフについて何も言及しなかったことに気付きます。 あなたは、このデータの視覚化を表示したいので、**Sheet 2** のピボット テーブルに合わせてグラフを生成するように Copilot に依頼するプロンプトを入力します。  
1. Copilot にスプレッドシートのデータの分析をリクエストするには、実際のスプレッドシートでそれを行う必要があります。 Sheet2 を表示したままで、Sheet1 のデータに基づくプロンプトを送信すると、Copilot がエラー メッセージを表示することがあります。 そうでない場合は、現在のシートのピボット テーブルの限られたデータでプロンプト リクエストを完了する方法の説明が示されます。 このような状況を回避するには、続行する前にスプレッドシート データを含むシートに戻る必要があります。 **Sheet1** を選択し、Copilot ウィンドウに次のプロンプトを入力します (注: Sheet2 を表示するためにスプレッドシートを更新する必要があり、その操作で Copilot ウィンドウが閉じた場合は、もう一度開きます。**Sheet 2 では、ピボット テーブルを作成して、各キャンペーンの種類によって生成された合計収益を分析しました。このデータを視覚化するグラフを作成してください**。
1. キャンペーンの種類別の収益を示す、Copilot によって作成されたグラフを確認します。 想定していた結果が得られたので、グラフの下部にある **[+ 新しいシートに追加]** ボタンを選択します。 これにより、このスプレッドシートの **Sheet 3** にこのグラフが追加されます。
1. **Sheet 3** を見て、Copilot がピボット テーブルと共にグラフも含めていたことに注目してください。 **Sheet 2** には同じピボット テーブルがありますが、**Sheet 3** にはテーブルとグラフがあることに、あなたは気付きます。 あなたは、表とグラフの両方を含む **Sheet 3** が必要であるため、今後の混乱を避けるために **Sheet 2** を削除することにします。 **Sheet 2** を削除するには、右クリックして、表示されるメニューから **[削除]** を選択し、**[OK]** を選択して削除を確定します。 これにより、Sheet 1 とSheet 3 が残ります。
1. さらに変更を加える場合は、**Sheet1** を選択して、Fabrikam Q1 marketing campaigns ファイルに戻ります。
1. 次に、最も効果的だったキャンペーンを特定します。 これを行うには、Copilot で各キャンペーンの投資収益率 (ROI) を計算します。 ROI を計算するには、Copilot ウィンドウに次のプロンプトを入力します。**各キャンペーンの ROI を計算します**。
1. このプロンプトの結果を確認します。 このプロンプトでは、Copilot によって各プロンプトについて計算した ROI が表示されると想定していました。 ただし、このテストでは、計算と各 ROI の計算にかかった手順が表示されるだけで、ROI 値が表示されない場合があります。 Copilot によって各キャンペーンの ROI が表示されなかった場合は、次のように、ROI を表示するように明示的に指示する修正したプロンプトを入力します。**各キャンペーンの ROI を計算して表示してください。** 計算が少しわかりにくいため、ROI の計算の下に表示される **[説明の表示]** オプションを選択します。 
1. 各キャンペーンの ROI が Copilot によってどのように計算されたかを学んだので、次は Copilot に ROI をスプレッドシートに追加してもらいます。 ROI テーブルの下部に表示される **[+ 列の挿入]** ボタンにカーソルを置きます (まだ選択しないでください)。 この操作により、スプレッドシートに ROI 列がどのように表示されるかに注目してください。 このボタンからカーソルを移動すると、列は表示されなくなります。 この機能により、挿入後の表示を確認できます。 この ROI 列に満足したら、**[+ 列の挿入]** ボタンを選択して、スプレッドシートへの ROI 列の追加を確定します。
1. 結果をメモします。 Copilot により、個々のキャンペーンの ROI を含む新しい列が追加されました。 これで問題ありませんが、Copilot にキャンペーンの種類ごとに ROI を決定してほしいと考えています。 あなたは、前のプロンプトを確認したときに、間違いに気付きました。 Copilot に各キャンペーンの ROI の計算を依頼しましたが、実際には、キャンペーンの種類ごとに ROI を計算したいと考えていました。 キャンペーンの種類ごとに ROI を計算するには、次のプロンプトを入力します。**その変更は適切に見えます。ただし、ROI について、さらに 2 つのことを実行してみましょう。まず、各キャンペーンの種類の ROI を計算します。次に、各キャンペーンの種類の ROI のグラフを表示します。**
1. 結果を確認します。 Copilot により、キャンペーンの種類別の ROI を示すグラフが作成されました。 このグラフをスプレッドシートに含めるには、グラフの下に表示される **[+ 新しいシートに追加]** オプションを選択します。 このテストでは、Copilot によってこのテーブルが新しい Sheet4 に追加されることもあれば、Sheet2 に追加されることもありました (Sheet2 は以前に削除したことに注意してください)。 どちらの場合でも、Copilot により、キャンペーンの種類別の ROI を含むピボット テーブルが作成され、対応するグラフが表示されました。 
1. このテスト中、この新しいグラフの X 軸上にある ROI の数値は、すべての数値が重なり合っていて判読できませんでした。 Copilot に作成を依頼したときのグラフは次のようになりました。<br><br>

    :::image type="content" source="../media/roi-campaign-bar-chart-illegible.png" alt-text="キャンペーンの種類別の ROI 棒グラフの元のバージョンのスクリーンショット。ROI 軸に判読できない数字が表示されています。" border="true":::

1. グラフがこのように表示される場合は、グラフを選択して罫線を強調表示し、グラフの右側にある縦罫線を少し右にドラッグします。 こうすることでグラフのサイズが拡張され、グラフから離すと ROI の数値が判読できるようになります。 <br><br>

    :::image type="content" source="../media/roi-campaign-bar-chart-legible.png" alt-text="キャンペーンの種類別の ROI 棒グラフの拡張バージョンのスクリーンショット。ROI 軸に読みやすい数字が表示されています。" border="true":::

1. このデータの確認が完了したら、**[Sheet 1]** を選択します。
1. これで、Copilot で、ユーザーを引き付けるのに最も効果的だったキャンペーンを識別できるようになりました。 このデータを視覚化する最善の方法は、対象ユーザーの合計とエンゲージメントの高いユーザーの合計の関係を示すグラフを Copilot に作成してもらう方法だと、あなたは感じました。 そのためには、Copilot ウィンドウに次のプロンプトを入力します。**ユーザーを引き付けるのに最も効果的だったキャンペーンを示すグラフを作成します**。
1. 結果を確認します。 Copilot がキャンペーン別のエンゲージメントの高いユーザーの合計数を要約しただけの場合、それはまさにあなたが望んでいたものではありません。 この結果を修正するには、次のプロンプトを入力します。**この種類のグラフは、私が探していたものではありません。対象ユーザーの合計とエンゲージメントの高いユーザーの合計数の関係を示すグラフを作成します**。
1. 結果を確認します。 対象ユーザーの合計数とエンゲージメントの高いユーザーの合計数との間の "関係を示す" グラフを作成するように Copilot に依頼したため、従来の棒グラフや円グラフではなく散布図が作成されました。 この種類のグラフを気に入ったので、新しいシートに追加します。 このテストでは、**[+ 新しいシートに追加]** ボタンではなく、**[+ シートに追加]** ボタンがグラフの下に表示されました。 いずれでも、表示されたボタンを選択します。  
1. ボタンに **[+ 新しいシートに追加]** と表示されている場合、Copilot によってグラフを含む新しいシートが作成されます。 このような場合は、次の手順に進みます。 ただし、ボタンに **[+ シートに追加]** と表示されていた場合、Copilot によってスプレッドシートの下の **Sheet1** にグラフが追加されたことに注意してください。 これは想定した結果ではないため、次のプロンプトを入力します。**グラフを Sheet1 に追加するのではなく、新しいシートに移動してください。** グラフを新しいシートに移動できなかったことを示すメッセージが Copilot から返された場合は、必要に応じて、表示された指示に従ってグラフを手動で新しいシートに移動することもできます。
1. **Sheet1** 以外のシートを表示している場合は、**Sheet1** を選択してスプレッドシートに戻ります。
1. Copilot に提供するデータの最後の部分があります。 あなたは、Copilot で、発生した収益に基づいて、最もパフォーマンスの高いキャンペーンを特定したいと考えます。 その後、この情報を使用して、最も収益性の高いキャンペーンを特定できます。 次のプロンプトを入力します。**発生した収益に基づいて、最もパフォーマンスの高いキャンペーンを特定します**。
1. 結果を確認します。 Copilot により、**キャンペーン名ごとの収益**を示すグラフが作成されました。 グラフの下のオプションを選択して **[+ 新しいシートに追加]** を行います。 こうすると、このテーブルが新しいシートに追加されます。 Copilot により、集合横棒グラフに加えて、キャンペーン別の総収益を表示するピボット テーブルも作成されました。 このデータの確認が完了したら、**Sheet 1** を選択します。
1. これで、Copilot に分析して欲しいデータが完成しました。 ただし、キャンペーン データをさらに分析するために Copilot が他にどのような提案をするかについて、あなたは興味があります。 プロンプト フィールドの上に表示される定義済みのプロンプトの一覧で、**[数式列の候補を表示する]** というタイトルの提案を探します。 この提案が表示された場合は、ここで選択します。 ただし、この提案が表示されない場合は、プロンプト フィールドに手動で入力します。
1. 列の候補を確認します。 これをスプレッドシートに追加する場合は、**[列の挿入]** ボタンを選択します。 スプレッドシート内の列の見た目に注目してください。
1. **[数式列の候補を表示する]** というタイトルの定義済みプロンプトが表示された場合は、それを選択します。 ただし、この定義済みプロンプトが表示されない場合は、プロンプト フィールドに手動で入力します。
1. 前の手順を数回繰り返して、Copilot によりさまざまな計算が提案されるようにします。 気に入ったものを挿入し、そうでないものはスキップします (たとえば、テスト中に**キャンペーン期間**を示す列が提案されましたが、追加する必要がありませんでした)。
1. あなたは、Copilot に、さまざまな種類のデータの関係を視覚化するグラフをさらに表示してもらいたいと考えています。 定義済みプロンプトの一覧で、**[データ分析情報の表示]** ボタンが表示されている場合はそれを選択します。表示されない場合は、プロンプト フィールドにこのプロンプトを手動で入力します。
1. 結果を確認します。 このグラフに関心がある場合は、**[新しいシートに追加]** ボタンを選択し、**[Sheet 1]** に戻ります。
1. 次に、**[別の分析情報を表示できますか?]** ボタンを選択します。 ここでも、このグラフに関心がある場合は、**[新しいシートに追加]** ボタンを選択し、**[Sheet 1]** に戻ります。
1. これらの最初の 2 つのグラフを見て、あなたは、Copilot が提供するさまざまなグラフを気に入りました。 あなたは、複数のグラフを 1 つずつ探す代わりに、データに基づいて Copilot で作成できるすべての分析情報をスプレッドシートに追加したいと考えています。 定義済みのプロンプトで、**[すべての分析情報をグリッドに追加]** プロンプトを選択します。 このプロンプトが表示されない場合は、手動で入力します。
1. 結果を確認します。 Copilot により、複数のピボット テーブルと共に、最終的なシートに複数のグラフが作成されました。 あなたは、Copilot in Excel が提供したすべてのデータを使用して、分析が完了したと判断します。 Excel でファイルが自動的に保存されたので、Microsoft Edge ブラウザー タブを閉じます。
